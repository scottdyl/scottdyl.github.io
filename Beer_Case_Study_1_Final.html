<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Beer_Case_Study_1_Final.utf8</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>








<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">My Portfolio</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Backstory</a>
</li>
<li>
  <a href="Beer_Case_Study_1_Final.html">Beer Case Study</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">




</div>


<p>l— output: word_document: default html_document: default —</p>
<pre class="r"><code># Questions - this chunk just holds all the questions for my reading

# 1.   How many breweries are present in each state?

# 2.   Merge beer data with the breweries data. Print the first 6 observations and the last six observations to check the merged file.  (RMD only, this does not need to be included in the presentation or the deck.)

# 3.   Address the missing values in each column.

# 4.   Compute the median alcohol content and international bitterness unit for each state. Plot a bar chart to compare.

# 5.   Which state has the maximum alcoholic (ABV) beer? Which state has the most bitter (IBU) beer?

# 6.   Comment on the summary statistics and distribution of the ABV variable.

# 7.   Is there an apparent relationship between the bitterness of the beer and its alcoholic content? Draw a scatter plot.  Make your best judgment of a relationship and EXPLAIN your answer.

# 8.  Budweiser would also like to investigate the difference with respect to IBU and ABV between IPAs (India Pale Ales) and other types of Ale (any beer with “Ale” in its name other than IPA).  You decide to use KNN classification to investigate this relationship.  Provide statistical evidence one way or the other. You can of course assume your audience is comfortable with percentages … KNN is very easy to understand conceptually.

# In addition, while you have decided to use KNN to investigate this relationship (KNN is required) you may also feel free to supplement your response to this question with any other methods or techniques you have learned.  Creativity and alternative solutions are always encouraged.  

# 9. Knock their socks off!  Find one other useful inference from the data that you feel Budweiser may be able to find value in.  You must convince them why it is important and back up your conviction with appropriate statistical evidence


library(tidyverse)
library(maps)
library(mapproj)
library(usmap)
library(curl)
library(class)
library(e1071)
library(caret)
library(plotly)
library(fuzzyjoin)
library(RCurl)</code></pre>
<p>Answering question 1 by creating a heat map: How many breweries are there for each state? Answer: top 5 are Colorado, California, Michigan, Oregon, Texas</p>
<pre class="r"><code># write up of the code

# Bringing in the brewery data
brew_data &lt;- read.csv(&#39;https://raw.githubusercontent.com/scottdyl/MSDS6306_CastStudy1/main/data/Breweries.csv&#39;)

# Counting each brewery by each state and renaming the count column to count
brewery_count = count(brew_data,State)

#trimming the extra spaces off of state
brewery_count$State = str_trim(brewery_count$State)

#getting the fips for each state for my map
brewery_count$fips = fips(brewery_count$State)

#renaming the &#39;n&#39; column to count 
colnames(brewery_count)[2] = &#39;Count&#39;

# creating the heat map
plot_usmap(data=brewery_count, values=&quot;Count&quot;, color = &quot;black&quot;) + scale_fill_gradient(name = &quot;Count of Breweries&quot;, low = &quot;white&quot;, high = &quot;red&quot;) + labs(title=&quot;Brewery Count by State&quot;) + theme(legend.position = &quot;top&quot;)</code></pre>
<p><img src="Beer_Case_Study_1_Final_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
<pre class="r"><code># getting the top 3 states by brewery for presentation
brewery_count$State[order(brewery_count$Count,decreasing = T)[1:5]]</code></pre>
<pre><code>## [1] &quot;CO&quot; &quot;CA&quot; &quot;MI&quot; &quot;OR&quot; &quot;TX&quot;</code></pre>
<p>Merging the two datasets from github and printing the first and last 6.</p>
<pre class="r"><code>brew_data &lt;- read.csv(&#39;https://raw.githubusercontent.com/scottdyl/MSDS6306_CastStudy1/main/data/Breweries.csv&#39;)
beer_data &lt;- read.csv(&#39;https://raw.githubusercontent.com/scottdyl/MSDS6306_CastStudy1/main/data/Beers.csv&#39;)

# changed the ID column name to match in each dataset and did a full join
colnames(beer_data)[5] = &#39;Brew_ID&#39;
bud_data &lt;- full_join(brew_data,beer_data,&#39;Brew_ID&#39;)

head(bud_data,6)</code></pre>
<pre><code>##   Brew_ID             Name.x        City State        Name.y Beer_ID   ABV IBU
## 1       1 NorthGate Brewing  Minneapolis    MN  Get Together    2692 0.045  50
## 2       1 NorthGate Brewing  Minneapolis    MN Maggie&#39;s Leap    2691 0.049  26
## 3       1 NorthGate Brewing  Minneapolis    MN    Wall&#39;s End    2690 0.048  19
## 4       1 NorthGate Brewing  Minneapolis    MN       Pumpion    2689 0.060  38
## 5       1 NorthGate Brewing  Minneapolis    MN    Stronghold    2688 0.060  25
## 6       1 NorthGate Brewing  Minneapolis    MN   Parapet ESB    2687 0.056  47
##                                 Style Ounces
## 1                        American IPA     16
## 2                  Milk / Sweet Stout     16
## 3                   English Brown Ale     16
## 4                         Pumpkin Ale     16
## 5                     American Porter     16
## 6 Extra Special / Strong Bitter (ESB)     16</code></pre>
<pre class="r"><code>tail(bud_data,6)</code></pre>
<pre><code>##      Brew_ID                        Name.x          City State
## 2405     556         Ukiah Brewing Company         Ukiah    CA
## 2406     557       Butternuts Beer and Ale Garrattsville    NY
## 2407     557       Butternuts Beer and Ale Garrattsville    NY
## 2408     557       Butternuts Beer and Ale Garrattsville    NY
## 2409     557       Butternuts Beer and Ale Garrattsville    NY
## 2410     558 Sleeping Lady Brewing Company     Anchorage    AK
##                         Name.y Beer_ID   ABV IBU                   Style Ounces
## 2405             Pilsner Ukiah      98 0.055  NA         German Pilsener     12
## 2406  Heinnieweisse Weissebier      52 0.049  NA              Hefeweizen     12
## 2407           Snapperhead IPA      51 0.068  NA            American IPA     12
## 2408         Moo Thunder Stout      50 0.049  NA      Milk / Sweet Stout     12
## 2409         Porkslap Pale Ale      49 0.043  NA American Pale Ale (APA)     12
## 2410 Urban Wilderness Pale Ale      30 0.049  NA        English Pale Ale     12</code></pre>
<p>Address the missing values in each column we removed 1005 beers due to missing values</p>
<pre class="r"><code># is it best to just filter out the missing data?
# how else would I fill it in? 
#unclean data count
dim(bud_data)</code></pre>
<pre><code>## [1] 2410   10</code></pre>
<pre class="r"><code>#summing possible missing values to see how much data we will lose
sum(is.na(bud_data$ABV))</code></pre>
<pre><code>## [1] 62</code></pre>
<pre class="r"><code>sum(is.na(bud_data$IBU))</code></pre>
<pre><code>## [1] 1005</code></pre>
<pre class="r"><code>#filtering out the missing values and leaving the full data in new dataframe
bud_data_clean&lt;- filter(bud_data,!is.na(bud_data$ABV)&amp;!is.na(bud_data$IBU)&amp;!is.na(bud_data$Style))
colnames(bud_data_clean)[2] = &quot;Brew Name&quot;
colnames(bud_data_clean)[5] = &quot;Beer Name&quot;
#clean data count
dim(bud_data_clean)</code></pre>
<pre><code>## [1] 1405   10</code></pre>
<p>we would like to find the median alcohol content and IBU for each state this will be presented in a bar chart ggplot used to show the median ABV and IBU for each state using the clean data</p>
<pre class="r"><code># I pipe in the data and group by state then summarize by median abv giving me median abv by state
bud_data_clean %&gt;% 
  group_by(State) %&gt;%
  summarise(median_ABV = median(ABV)) %&gt;%
  #I use ggplot bar to plot the data
  ggplot(aes(State,median_ABV,fill = median_ABV)) +
  geom_bar(stat = &#39;identity&#39;,width = .75,color = &#39;black&#39;)+
  scale_fill_gradient(low = &#39;white&#39;, high = &#39;black&#39;) +
  labs(title=&quot;Median ABV by State&quot;, x=&quot;State&quot;, y=&quot;Median ABV&quot;)+
  theme(axis.text.x = element_text(angle = 90, vjust = .3))</code></pre>
<p><img src="Beer_Case_Study_1_Final_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<pre class="r"><code># This code does the same as the ABV but by IBU
bud_data_clean %&gt;% 
  group_by(State) %&gt;%
  summarise(median_IBU = median(IBU)) %&gt;%
  #I use ggplot bar to plot the data
  ggplot(aes(State,median_IBU,fill = median_IBU)) +
  geom_bar(stat = &#39;identity&#39;,width = .75,color = &#39;black&#39;)+
  scale_fill_gradient(low = &#39;white&#39;, high = &#39;black&#39;) +
  labs(title=&quot;Median IBU by State&quot;, x=&quot;State&quot;, y=&quot;Median IBU&quot;)+
  theme(axis.text.x = element_text(angle = 90, vjust = .3))</code></pre>
<p><img src="Beer_Case_Study_1_Final_files/figure-html/unnamed-chunk-5-2.png" width="672" /></p>
<p>we will calculate which state has highest ABV and IBU beer finding the max and selecting the row</p>
<pre class="r"><code># use grep to find the max value then select the columns from the data to show which city, state, name of the beer and name of the brewery
bud_data_clean[grep(max(bud_data_clean$ABV),bud_data_clean$ABV),] %&gt;% select(City, State, `Beer Name`, `Brew Name`, ABV, Style)</code></pre>
<pre><code>##         City State      Beer Name                 Brew Name   ABV
## 8 Louisville    KY London Balling Against the Grain Brewery 0.125
##                Style
## 8 English Barleywine</code></pre>
<pre class="r"><code>bud_data_clean[grep(max(bud_data_clean$IBU),bud_data_clean$IBU),] %&gt;% select(City, State, `Beer Name`, `Brew Name`, IBU, Style)</code></pre>
<pre><code>##         City State                 Beer Name               Brew Name IBU
## 1134 Astoria    OR Bitter Bitch Imperial IPA Astoria Brewing Company 138
##                               Style
## 1134 American Double / Imperial IPA</code></pre>
<p>Comment on the summary statistics and distribution of the ABV variable. for this I will be using a histogram to show the distribution we showed how the distribution of ABV was by using a histogram</p>
<pre class="r"><code># here I pipe the budwiser data into a ggplot using the variable ABV and create a histogram
bud_data_clean %&gt;%
  ggplot(aes(ABV)) +
  geom_histogram(fill =&#39;black&#39;, binwidth = .0025, color = &#39;white&#39;) +
  labs(title=&quot;Distribution of ABV&quot;)</code></pre>
<p><img src="Beer_Case_Study_1_Final_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<pre class="r"><code>summary(bud_data_clean$ABV)</code></pre>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
## 0.02700 0.05000 0.05700 0.05991 0.06800 0.12500</code></pre>
<pre class="r"><code>#summarize the data by min, max, mean, median, and standard deviation
summarise(bud_data_clean,
          max=max(ABV),
          min=min(ABV),
          mean = mean(ABV),
          median = median(ABV),
          sd=sd(ABV))</code></pre>
<pre><code>##     max   min       mean median         sd
## 1 0.125 0.027 0.05991388  0.057 0.01357633</code></pre>
<p>Is there an apparent relationship between the bitterness of the beer and its alcoholic content? Draw a scatter plot. Make your best judgment of a relationship and EXPLAIN your answer.</p>
<p>Answer: their appears to be a direct correlation between ABV and IBU. this is presented in the graph below with a strong positive relationship.</p>
<pre class="r"><code>bud_data_clean %&gt;%
  ggplot(aes(ABV, IBU)) +
  geom_jitter(width = .01) +
  geom_smooth(method = &#39;lm&#39;, se = F, color = &#39;red&#39;)+
  labs(title=&quot;Bitterness vs Alcohol&quot;, x=&quot;Alcohol Content by Volume&quot;, y=&quot;IBU&quot;)</code></pre>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="Beer_Case_Study_1_Final_files/figure-html/unnamed-chunk-8-1.png" width="672" /> # 8. Budweiser would also like to investigate the difference with respect to IBU and ABV between IPAs (India Pale Ales) and other types of Ale (any beer with “Ale” in its name other than IPA). You decide to use KNN classification to investigate this relationship. Provide statistical evidence one way or the other. You can of course assume your audience is comfortable with percentages … KNN is very easy to understand conceptually.</p>
<p>Answer: IBU is a better variable to tell IPA from an Ale over ABV. Overall this model was 86% accurate. IBU was a better descriptor than ABV shown by the clustering of the two beers</p>
<pre class="r"><code># include IPA into one category and ales into another but exclude &quot;india pale ale&quot; from the ale section
# test example is  &quot;english india pale ale (IPA)&quot;
# how to do this? filter out all the IPAs first to ensure you don&#39;t get them put into the ale section - filter out the ales and merge with IPA data

IPA_Brew &lt;- bud_data_clean %&gt;% filter(grepl(&quot;IPA&quot;,Style) | grepl(&quot;India Pale Ale&quot;, Style))
IPA_Brew$General_Style&lt;-&quot;IPA&quot;

Ale_Brew &lt;- bud_data_clean[grepl(&quot;Ale&quot;,bud_data_clean$Style) &amp; !grepl(&quot;India Pale Ale&quot;,bud_data_clean$Style) &amp; !grepl(&quot;IPA&quot;, bud_data_clean$Style),]
Ale_Brew$General_Style&lt;-&quot;Ale&quot;

Beer_train&lt;- rbind(IPA_Brew,Ale_Brew)

Beer_train %&gt;% ggplot(aes(ABV, IBU, color = General_Style)) + geom_jitter(width=.01) + labs(title=&quot;Scatterplot Bitterness vs Alcohol of IPAs and Ales&quot;, x=&quot;Alcohol Content (ABV)&quot;, y=&quot;Bitterness (IBU)&quot;)</code></pre>
<p><img src="Beer_Case_Study_1_Final_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<pre class="r"><code>#KNN train where we set seed to 99 and do a 70/30 split of the data
set.seed(99)
split_data = .70
train_split = sample(1:dim(Beer_train)[1],round(split_data * dim(Beer_train)[1]))
train = Beer_train[train_split,]
test = Beer_train[-train_split,]


#setting up the data frame to find the most accurate K value
accs = data.frame(accuracy = numeric(75), k = numeric(75))

# for loop that runs 75 times over upping the k value by 1 each time k=1:75
for(i in 1:75)
{
  classifications = knn(train[,c(7,8)],test[,c(7,8)],train$General_Style, prob = TRUE, k = i)
  table(test$General_Style,classifications)
  CM = confusionMatrix(table(test$General_Style,classifications))
  accs$accuracy[i] = CM$overall[1]
  accs$k[i] = i
}
# plotting k and accuracy to see visually how k performs over time
plot(accs$k,accs$accuracy, type = &quot;l&quot;, xlab = &quot;k&quot;, ylab = &quot;Accurcy by Percent&quot;)</code></pre>
<p><img src="Beer_Case_Study_1_Final_files/figure-html/unnamed-chunk-9-2.png" width="672" /></p>
<pre class="r"><code>#filtering by the best accuracy value
filter(accs, accuracy == max(accs$accuracy))</code></pre>
<pre><code>##    accuracy  k
## 1 0.8551237 32</code></pre>
<pre class="r"><code>#we will use K = 32 here because that gave us the best results given seed 99
classifications = knn(train[,c(7,8)],test[,c(7,8)],train$General_Style, prob = TRUE, k = 32)
table(test$General_Style,classifications)</code></pre>
<pre><code>##      classifications
##       Ale IPA
##   Ale 137  20
##   IPA  21 105</code></pre>
<pre class="r"><code>confusionMatrix(table(test$General_Style,classifications))</code></pre>
<pre><code>## Confusion Matrix and Statistics
## 
##      classifications
##       Ale IPA
##   Ale 137  20
##   IPA  21 105
##                                          
##                Accuracy : 0.8551         
##                  95% CI : (0.8086, 0.894)
##     No Information Rate : 0.5583         
##     P-Value [Acc &gt; NIR] : &lt;2e-16         
##                                          
##                   Kappa : 0.7065         
##                                          
##  Mcnemar&#39;s Test P-Value : 1              
##                                          
##             Sensitivity : 0.8671         
##             Specificity : 0.8400         
##          Pos Pred Value : 0.8726         
##          Neg Pred Value : 0.8333         
##              Prevalence : 0.5583         
##          Detection Rate : 0.4841         
##    Detection Prevalence : 0.5548         
##       Balanced Accuracy : 0.8535         
##                                          
##        &#39;Positive&#39; Class : Ale            
## </code></pre>
<div id="this-is-the-code-dylan-used-to-answer-qustion-9" class="section level1">
<h1>This is the code Dylan used to answer qustion 9</h1>
</div>
<div id="knock-their-socks-off-find-one-other-useful-inference-from-the-data-that-you-feel-budweiser-may-be-able-to-find-value-in.-you-must-convince-them-why-it-is-important-and-back-up-your-conviction-with-appropriate-statistical-evidence" class="section level1">
<h1>9. Knock their socks off! Find one other useful inference from the data that you feel Budweiser may be able to find value in. You must convince them why it is important and back up your conviction with appropriate statistical evidence</h1>
</div>
<div id="is-one-state-more-likly-to-purchase-local-where-is-there-a-gap-in-that-states-beer" class="section level1">
<h1>is one state more likly to purchase local? Where is there a gap in that states beer?</h1>
</div>
<div id="this-is-using-data-from-another-study-which-can-be-found-on-the-github-and-is-cited-in-the-slides" class="section level1">
<h1>This is using data from another study which can be found on the github and is cited in the slides</h1>
<p>Overall Maine had the best chance for a successful booze stout by having a high ABV average but a middle of the road ABV max</p>
<pre class="r"><code># we want to plot the max and median ABV by state and eliminate a state if their regulations are too high
# next we will find a gap in the market by showing number of stouts/porters by states and give reccomondations

#filter the data to stout and get a summary to see what the max abv is
stout_porter &lt;- bud_data_clean %&gt;% filter(grepl(&quot;Stout&quot;,Style) | grepl(&quot;Porter&quot;, Style))
summary(stout_porter$ABV)</code></pre>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
## 0.03700 0.05500 0.06000 0.06572 0.07100 0.12000</code></pre>
<pre class="r"><code>#getting the max and median abv by state by using aggregate
state_abv = aggregate(ABV~State,data = bud_data_clean,max)
avg_abv = aggregate(ABV~State,data = bud_data_clean,median)

#trimming off those empty spaces of state from the data *cleaning*
state_abv$State = str_trim(state_abv$State)
avg_abv$State = str_trim(avg_abv$State)

#getting the fips for each state for my map
state_abv$fips = fips(state_abv$State)
avg_abv$fips = fips(avg_abv$State)

#renaming the &#39;n&#39; column to count 
colnames(state_abv)[2] = &#39;abv&#39;
colnames(avg_abv)[2] = &#39;abv&#39;

# creating the heat map
plot_usmap(data=state_abv, values=&quot;abv&quot;, color = &quot;black&quot;) + 
  scale_fill_gradient(name = &quot;ABV Scale&quot;, low = &quot;white&quot;, high = &quot;red&quot;) + 
  labs(title=&quot;Highest ABV by State&quot;) + theme(legend.position = &quot;top&quot;)</code></pre>
<p><img src="Beer_Case_Study_1_Final_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<pre class="r"><code>plot_usmap(data=avg_abv, values=&quot;abv&quot;, color = &quot;black&quot;) + 
  scale_fill_gradient(name = &quot;ABV Scale&quot;, low = &quot;white&quot;, high = &quot;red&quot;) + 
  labs(title=&quot;Median ABV by State&quot;) + theme(legend.position = &quot;top&quot;)</code></pre>
<p><img src="Beer_Case_Study_1_Final_files/figure-html/unnamed-chunk-10-2.png" width="672" /></p>
<pre class="r"><code>#counting stouts and porters by state
stout_count = count(stout_porter,State)
#changing the column name from n to count
colnames(stout_count)[2] = &#39;Count&#39;
#creating a bar graph by state to show number of stouts
stout_count %&gt;%
  ggplot(aes(State,Count,fill = Count)) +
  geom_bar(stat = &#39;identity&#39;,width = .75,color = &#39;black&#39;)+
  scale_fill_gradient(low = &#39;white&#39;, high = &#39;black&#39;) +
  labs(title=&quot;Number of Stouts or Porters by State&quot;, x=&quot;State&quot;, y=&quot;Count of Stouts or Porters&quot;)+
  theme(axis.text.x = element_text(angle = 90, vjust = .3))</code></pre>
<p><img src="Beer_Case_Study_1_Final_files/figure-html/unnamed-chunk-10-3.png" width="672" /></p>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
